
<div align="center">

```
 â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•—  â–ˆâ–ˆâ•—    â–ˆâ–ˆâ•—     â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ•—   â–ˆâ–ˆâ•—â–ˆâ–ˆâ•—   â–ˆâ–ˆâ•—â–ˆâ–ˆâ•—  â–ˆâ–ˆâ•—
â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘    â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•
â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘    â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â–ˆâ–ˆâ•— â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘ â•šâ–ˆâ–ˆâ–ˆâ•”â• 
â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘    â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘ â–ˆâ–ˆâ•”â–ˆâ–ˆâ•— 
â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘ â•šâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•”â• â–ˆâ–ˆâ•—
â•šâ•â•  â•šâ•â•â•šâ•â•  â•šâ•â• â•šâ•â•â•â•â•â•â•šâ•â•  â•šâ•â•    â•šâ•â•â•â•â•â•â•â•šâ•â•â•šâ•â•  â•šâ•â•â•â• â•šâ•â•â•â•â•â• â•šâ•â•  â•šâ•â•
```

### **Microsoft Surface Pro 8 â€” Arch Linux Install Script**
*Gaming-optimized Â· COSMIC Desktop Â· linux-surface kernel Â· Steam-ready*

---

![Arch Linux](https://img.shields.io/badge/Arch_Linux-1793D1?style=for-the-badge&logo=arch-linux&logoColor=white)
![Surface Pro 8](https://img.shields.io/badge/Surface_Pro_8-0078D4?style=for-the-badge&logo=microsoft&logoColor=white)
![COSMIC DE](https://img.shields.io/badge/COSMIC_Desktop-5E35B1?style=for-the-badge&logo=linux&logoColor=white)
![Steam](https://img.shields.io/badge/Steam-000000?style=for-the-badge&logo=steam&logoColor=white)
![Shell](https://img.shields.io/badge/Bash-4EAA25?style=for-the-badge&logo=gnu-bash&logoColor=white)

</div>

---

## ğŸ¯ What Is This?

A **single-script, fully automated Arch Linux installer** purpose-built for the **Microsoft Surface Pro 8**. Boot the Arch ISO, run one command, walk away. When you come back you'll have a complete, gaming-ready system with the COSMIC desktop environment, the `linux-surface` kernel, Steam, and Phantom Browser â€” tuned specifically for the Surface Pro 8's hardware.

No hand-holding through `pacstrap` steps. No forgotten packages. No rebooting into a broken system. Just fill in your username and password at the top of the script, run it, and reboot.

---

## ğŸ’» Target Hardware

| Component | Spec |
|---|---|
| ğŸ–¥ï¸ **Device** | Microsoft Surface Pro 8 |
| ğŸ§  **CPU** | Intel Core i5-1135G7 (11th Gen Tiger Lake) |
| ğŸ® **GPU** | Intel Iris Xe â€” Tiger Lake-LP GT2 |
| ğŸ§© **RAM** | 8 GB LPDDR4x |
| ğŸ’¾ **Storage** | NVMe SSD (auto-detected) |
| ğŸ–±ï¸ **Input** | Surface Touch + Pen via `iptsd` |

---

## âš¡ Quickstart

> **Prerequisites:** Boot the official [Arch Linux ISO](https://archlinux.org/download/), connect to the internet via `iwctl` or USB-C Ethernet, then:

```bash
# 1. Download the script
curl -O https://raw.githubusercontent.com/YOUR_USERNAME/YOUR_REPO/main/surface_pro8_arch_install.sh

# 2. Open it and fill in your username, password, and timezone
nano surface_pro8_arch_install.sh

# 3. Make it executable and run
chmod +x surface_pro8_arch_install.sh && bash surface_pro8_arch_install.sh
```

> âš ï¸ **This will erase your entire disk.** The script asks for confirmation before touching anything. Double-check your disk target before typing `yes`.

---

## ğŸ—‚ï¸ What The Script Does â€” Step by Step

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ”  Safety checks â€” UEFI mode, network, passwords  â”‚
â”‚  ğŸ’¿  Disk detection â€” NVMe auto-detected            â”‚
â”‚  ğŸ—‚ï¸  Partitioning â€” 1 GB EFI + root (ext4)          â”‚
â”‚  ğŸ’¤  16 GB swapfile â€” tuned for 8 GB RAM + gaming   â”‚
â”‚  ğŸ“¦  pacstrap â€” base system + intel-ucode           â”‚
â”‚  âš™ï¸   chroot â€” locale, users, sudo, bootloader      â”‚
â”‚  ğŸ¥¾  systemd-boot â€” dual entries (stock + surface)  â”‚
â”‚  ğŸ§  linux-surface kernel â€” proper SP8 support      â”‚
â”‚  âœ‹  iptsd â€” touchscreen & pen daemon               â”‚
â”‚  ğŸ®  Steam + gaming stack                           â”‚
â”‚  ğŸ”’  UFW firewall + Thermald                        â”‚
â”‚  ğŸŒŒ  COSMIC Desktop + cosmic-greeter                â”‚
â”‚  ğŸ‘»  Phantom Browser â€” from GitHub releases         â”‚
â”‚  ğŸ”§  Performance tuning â€” sysctl + CPU governor     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ§ The linux-surface Kernel

The stock Arch kernel works on Surface hardware â€” but only barely. The `linux-surface` kernel adds patches maintained by the [linux-surface project](https://github.com/linux-surface/linux-surface) that unlock full hardware support:

| Feature | Stock Kernel | linux-surface |
|---|---|---|
| ğŸ–±ï¸ Touchscreen | âŒ Broken | âœ… Works |
| âœï¸ Surface Pen | âŒ Not detected | âœ… Works |
| ğŸ“· Cameras | âŒ Not supported | âœ… Works |
| ğŸ”‹ Battery reporting | âš ï¸ Partial | âœ… Full |
| ğŸ’¤ Modern Standby (S0ix) | âš ï¸ Unreliable | âœ… Tuned |
| âŒ¨ï¸ Type Cover | âœ… Works | âœ… Works |

The script installs **both** kernels and creates separate `systemd-boot` entries for each. The `linux-surface` entry is set as default. The stock kernel entry remains as a fallback.

---

## ğŸŒŒ COSMIC Desktop Environment

[COSMIC](https://github.com/pop-os/cosmic-epoch) is System76's fully Rust-native desktop environment â€” Wayland-first, tiling-capable, and blazing fast. It's available in the **official Arch `extra` repository** and installed as the full `cosmic` package group, which includes:

- ğŸ–¥ï¸ `cosmic-comp` â€” Wayland compositor
- ğŸ§­ `cosmic-panel` â€” top bar and dock
- ğŸ“ `cosmic-files` â€” file manager
- ğŸ’» `cosmic-terminal` â€” GPU-accelerated terminal
- ğŸ¨ `cosmic-settings` â€” system settings
- ğŸ” `cosmic-greeter` â€” display manager / login screen
- ğŸ”‹ `power-profiles-daemon` â€” Power & Battery panel support
- ğŸ“‚ `xdg-user-dirs` â€” standard user folders (Documents, Pictures, etc.)

> No AUR, no `paru`, no compiling from source. Pure `pacman`.

---

## ğŸ® Gaming Stack

The script builds a complete Steam gaming environment optimized for Intel Iris Xe graphics on the Surface Pro 8.

### Packages Installed

| Package | Purpose |
|---|---|
| `steam` | Game library and launcher |
| `lib32-mesa` + `lib32-vulkan-intel` | 32-bit Vulkan for older games via Proton |
| `vulkan-intel` + `vulkan-tools` | Native Vulkan for Intel Iris Xe |
| `gamemode` + `lib32-gamemode` | Automatic CPU/GPU optimisation on game launch |
| `intel-media-driver` | VA-API hardware video decode |
| `wine-staging` + `winetricks` | Windows compatibility layer |
| `ttf-liberation` | Font substitutes required by many Steam games |

### Steam Launch Options

Add these to any game's launch options in Steam for best performance:

```
gamemoderun %command%
```

For hardware video decode in supported games:
```
LIBVA_DRIVER_NAME=iHD gamemoderun %command%
```

### Performance Tuning Applied

```ini
# /etc/sysctl.d/99-gaming.conf

vm.swappiness          = 10      # Keep RAM preferred; swap is overflow only
vm.vfs_cache_pressure  = 50      # Retain filesystem cache longer
vm.max_map_count       = 2147483642  # Required by Proton / many Linux games
vm.dirty_ratio         = 10      # Reduce disk write stall during gameplay
vm.dirty_background_ratio = 5
```

A `systemd` service locks all CPU cores to the **performance** governor at boot â€” no waiting for the scheduler to ramp up during game load screens.

---

## ğŸ’¤ Swap Configuration

| | Value |
|---|---|
| ğŸ’¾ Physical RAM | 8 GB |
| ğŸ”„ Swapfile | **16 GB** |
| ğŸ“ Location | `/swapfile` |
| âš™ï¸ `vm.swappiness` | `10` (RAM strongly preferred) |
| ğŸ—‚ï¸ fstab entry | âœ… Persistent across reboots |
| âš¡ Creation method | `fallocate` (instant, not `dd`) |

16 GB of swap gives the kernel plenty of overflow headroom when gaming with multiple background apps, without swapping aggressively during normal use thanks to the low swappiness value.

---

## ğŸ‘» Phantom Browser

[Phantom Browser](https://github.com/greysonofusa/degoogledchromium) â€” a de-Googled, privacy-hardened Chromium build based on [Cromite](https://github.com/uazo/cromite) â€” is pulled directly from the GitHub releases API at install time as a Linux x64 AppImage.

```
âœ… No Google services
âœ… No telemetry or crash reporting  
âœ… Built-in ad blocking
âœ… Brave Search pre-installed
âœ… Auto-update checker built in
```

The script handles the AppImage lifecycle completely â€” download, `chmod +x`, symlink to `/usr/local/bin/phantom-browser`, pulls the official icon from the repo, and registers a `.desktop` entry so it appears in the COSMIC launcher.

> **Note:** The Linux AppImage build is still in progress. If no Linux build is found in the latest release at install time, the script exits cleanly and prints instructions. It will self-install the next time you run it once the Linux build goes live.

---

## ğŸ”’ Security & Network

```
ğŸ›¡ï¸  UFW firewall
    â”œâ”€â”€ Default: deny all incoming
    â”œâ”€â”€ Default: allow all outgoing
    â””â”€â”€ Enabled at boot via systemd

ğŸŒ¡ï¸  thermald
    â””â”€â”€ Intel thermal management daemon â€” prevents Tiger Lake throttling

ğŸ”‘  sudo
    â””â”€â”€ wheel group only â€” no passwordless sudo
```

---

## ğŸ¥¾ Boot Entries

The script creates two `systemd-boot` entries:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â˜…  Arch Linux â€” linux-surface  [DEFAULT]            â”‚
â”‚     Full Surface hardware support                    â”‚
â”‚                                                      â”‚
â”‚     Arch Linux â€” linux (stock)  [FALLBACK]           â”‚
â”‚     Standard Arch kernel                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

Kernel boot parameters applied to both entries:

```
mem_sleep_default=s2idle   # Modern Standby for Surface
i915.enable_psr=1          # Panel Self Refresh â€” saves battery
i915.enable_fbc=1          # Framebuffer compression
mitigations=off            # Spectre/Meltdown mitigations off for perf
nohz_full=1-3              # Tickless CPU cores for gaming
threadirqs                 # Threaded IRQs â€” smoother under load
nowatchdog                 # Disable watchdog â€” reduces latency
ibt=off                    # Required for some Proton/Wine compatibility
```

A **pacman hook** automatically syncs the kernel and initramfs to the ESP after every `pacman -Syu` so your boot entries never go stale after an update.

---

## ğŸ“ Configuration â€” Edit Before Running

Open the script and set these variables at the top before running:

```bash
HOSTNAME="surface-arch"       # your machine's hostname
USERNAME="yourname"           # your regular user account
USER_PASS="your-password"     # â† CHANGE THIS
ROOT_PASS="your-password"     # â† CHANGE THIS
TIMEZONE="America/Chicago"    # timedatectl list-timezones
DISK=""                       # blank = auto-detect NVMe, or set e.g. /dev/nvme0n1
```

---

## ğŸ”§ Post-Install Checklist

```
â–¡  Reboot and select "linux-surface" at the boot menu
â–¡  Log into COSMIC via cosmic-greeter
â–¡  Connect to Wi-Fi via COSMIC Settings â†’ Network
â–¡  Open Steam â†’ Settings â†’ Compatibility â†’ Enable Steam Play for all titles
â–¡  Set game launch options to: gamemoderun %command%
â–¡  Run 'gpu-check' in cosmic-terminal to verify Intel Xe Vulkan + VA-API
â–¡  Check Phantom Browser is in the COSMIC app launcher
```

---

## âš ï¸ Known Limitations

- **Secure Boot** must be disabled in the Surface UEFI before booting the Arch ISO
- **BitLocker** (if previously enabled) must be fully decrypted before wiping
- **Cameras** require `linux-surface` kernel â€” they will not work on the stock kernel
- **Phantom Browser Linux AppImage** may not be in the latest release yet â€” the script handles this gracefully

---

## ğŸ™ Credits & Upstream Projects

| Project | Role |
|---|---|
| [Arch Linux](https://archlinux.org) | The base system |
| [linux-surface](https://github.com/linux-surface/linux-surface) | Surface kernel patches |
| [System76 / COSMIC](https://github.com/pop-os/cosmic-epoch) | Desktop environment |
| [Phantom Browser](https://github.com/greysonofusa/degoogledchromium) | Privacy browser |
| [Cromite](https://github.com/uazo/cromite) | Chromium base for Phantom |
| [Valve / Steam](https://store.steampowered.com) | Gaming platform |
| [FeralInteractive / gamemode](https://github.com/FeralInteractive/gamemode) | Gaming optimiser |

---

<div align="center">

**Built for privacy. Optimized for gaming. Designed for the Surface Pro 8.**

*Pull requests and issues welcome.*

![Arch Linux](https://img.shields.io/badge/BTW_I_use-Arch-1793D1?style=flat-square&logo=arch-linux&logoColor=white)

</div>
